<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="icon" href="/icons/favicon.ico?v=1.0" type="image/x-icon">
  <link rel="shortcut icon" href="/icons/favicon.ico?v=1.0" type="image/x-icon">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png?v=1.0">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png?v=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png?v=1.0">
  <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167x167.png?v=1.0">
  <link rel="manifest" href="/icons/manifest.json?v=1.0">
  <meta name="theme-color" content="#2196f3">
  <meta property="og:title" content="Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù†">
  <meta property="og:description" content="Ú†Ø§Ù¾ Ø§Ù†ÙˆØ§Ø¹ Ù¾ÙˆØ³ØªØ±Ù‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ">
  <meta property="og:image" content="/icons/og-image.jpg?v=1.0">
  <meta property="og:url" content="https://akbari5561.github.io/PosterIran/">

  <link rel="preload" as="image" href="https://akbari5561.github.io/PosterIran/icons/apple-touch-icon-180x180.png">
  
  <style>
/* Import Vazirmatn font from Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap');

    body {
      font-family: 'Vazirmatn', sans-serif; /* Apply Vazirmatn font */
      direction: rtl;
      background: #E3F2FD; /* Softer background#543AFB */
      color: #333;
      padding: 0; /* Remove default body padding */
      margin: 0; /* Remove default body margin */
      display: flex;
      flex-direction: column;
      min-height: 100vh; /* Ensure body takes full viewport height */
      align-items: center; /* Center content horizontally */
      justify-content: center; /* Center content vertically */
      position: relative; /* Add this to position particles relative to body */
    }

    /* Particles.js container styling */
    #particles-js {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: #030C41; /* Dark blue background color for the particles */
      background-image: url("");
      background-repeat: no-repeat;
      background-size: cover;
      background-position: 50% 50%;
      z-index: -1; /* Layer 1: Bottommost layer for background */
    }

    /* Enhanced Hero Section for the main page */
    #mainSection {
        margin-top: 0;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100%;
        max-width: 900px; /* Max width for content */
        padding: 40px 20px; /* More padding */
        box-sizing: border-box;
        background: #067FB580; /* Semi-transparent blue background */
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15); /* More prominent shadow */
        text-align: center;
        position: relative;
        z-index: 1; /* Layer 2: Main content */
    }
    
    .main-title-container {
        margin-bottom: -10px;
        padding: 0px 0px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column; /* Stack logo, h1, h2 */
        position: relative; /* Ensure it's above pseudo-elements */
        z-index: 1; /* Bring to front */
        
    }

    .header-logo {
        max-width: 180px; /* Adjusted size for the new layout */
        height: auto;
        margin-bottom: -10px; /* Space between logo and title */
    }

    h1 {
        color: #FFFFFF; /* Deeper blue for main title */
        font-size: 3em; /* Larger font size */
        margin: 0; /* Remove default margin */
        text-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        letter-spacing: 1.5px;
    }
    h2 {
        color: #FFFFFF; /* Slightly lighter blue for subtitle */
        font-size: 1.2em;
        margin-top: 10px; /* Space below h1 */
        margin-bottom: 0px; /* No extra space below h2 */
        
    }
    #subtitle {
        font-size: 1.2em;
        color: #FFFFFF;
        margin-top: 5px;
        position: relative; /* Ensure it's above pseudo-elements */
        z-index: 1; /* Bring to front */
    }
    #address {
        z-index: 1; /* Bring to front */
    }
    #address p {
        margin: 5px 0;
        font-size: 1em;
        color: #FFFFFF;
    }
    #address a {
        color: #444; /* Darker blue for links */
        text-decoration: none;
        font-weight: bold;
        transition: color 0.3s ease;
    }
    #address a:hover {
        color: #1976D2;
    }

    #loginSection, #clearCartButtonSection {
        margin-top: 40px;
        display: flex;
        gap: 20px; /* Space between buttons */
        position: relative; /* Add this */
        z-index: 2; /* Layer 3: Buttons and controls on main section */
    }
    #clearCartButtonSection {
        margin-top: 20px;
        display: none; /* Hide by default, show with JS */
    }
    button {
    background-color: #2196f3;
    color: white;
    border: none;
    padding: 4px 20px;
    margin: 5px;
    box-shadow: 0  2px 5px rgba(1, 1, 5);
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}
    button:hover {
      background-color: #1976d2;
      transform: translateY(-3px); /* Lift effect on hover */
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
    }
    button.remove-btn {
      background-color: #f44336;
      box-shadow: none; /* No shadow for small buttons */
    }
    button.remove-btn:hover {
      background-color: #d32f2f;
      transform: none; /* No lift for small buttons */
    }
    button.clear-cart-btn {
      background-color: #ff9800; /* Orange for clear cart */
    }
    button.clear-cart-btn:hover {
      background-color: #fb8c00;
    }
    /* Style for quantity dropdowns in both gallery and cart */
    .quantity-select {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
      width: 70px; /* Ø¹Ø±Ø¶ Ø«Ø§Ø¨Øª Ø¨Ø±Ø§ÛŒ Ø¬Ø§ Ø´Ø¯Ù† Ø¹Ø¯Ø¯ Ú†Ù‡Ø§Ø± Ø±Ù‚Ù…ÛŒ */
      min-width: 50px; /* Ø­Ø¯Ø§Ù‚Ù„ Ø¹Ø±Ø¶ Ù…Ø¬Ø§Ø² */
      max-width: 70px; /* Ø­Ø¯Ø§Ú©Ø«Ø± Ø¹Ø±Ø¶ Ù…Ø¬Ø§Ø² */
      box-sizing: border-box; /* Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ù¾Ø¯ÛŒÙ†Ú¯ Ùˆ Ø¨Ø±Ø¯Ø± Ø±ÙˆÛŒ Ø¹Ø±Ø¶ Ø­Ø³Ø§Ø¨ Ø¨Ø´Ù† */
      text-align: center; /* Ù…ØªÙ† Ø¯Ø§Ø®Ù„Ø´ ÙˆØ³Ø·â€ŒÚ†ÛŒÙ† Ø¨Ø´Ù‡ */
  }
    /* Style for the Group Selection dropdown */
    .group-select-fixed { /* Ø¯Ø±ÙˆÙ¾â€ŒØ¯Ø§ÙˆÙ† Ø§Ù†ØªØ®Ø§Ø¨ Ú¯Ø±ÙˆÙ‡ */
        width: 160px;
        min-width: 100px;
        max-width: 200px;
        padding: 3px;
        border-radius: 6px;
        border: 2px solid #29B6F6;
        margin: 5px;
        box-sizing: border-box;
        text-align: right;
        font-size: 16px; /* ÙØ§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª Ø±Ø§ Ø¨Ù‡ Û±Û¶ Ù¾ÛŒÚ©Ø³Ù„ ØªØºÛŒÛŒØ± Ø¯Ø§Ø¯ÛŒÙ… */
    }
    /* Main sections styling */
    #adminLogin, #gallery, #cartSection {
        margin-top: 10px; /* ÙØ§ØµÙ„Ù‡ Ú¯Ø§Ù„Ø±ÛŒ Ø§Ø² Ø¨Ø§Ù„Ø§ */
        flex-grow: 1; /* Allow sections to take available space */
        display: none; /* Hidden by default, controlled by JS */
        flex-direction: column; /* For consistent layout */
    }
    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø± Ú¯Ø§Ù„Ø±ÛŒ (Ø¬Ø¯ÛŒØ¯) */
    .quantity-input {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
      width: 60px; /* Ø¹Ø±Ø¶ Ø«Ø§Ø¨Øª Ø¨Ø±Ø§ÛŒ Ø¬Ø§ Ø´Ø¯Ù† Ø¹Ø¯Ø¯ Ø³Ù‡ Ø±Ù‚Ù…ÛŒ */
      min-width: 50px; /* Ø­Ø¯Ø§Ù‚Ù„ Ø¹Ø±Ø¶ Ù…Ø¬Ø§Ø² */
      max-width: 70px; /* Ø­Ø¯Ø§Ú©Ø«Ø± Ø¹Ø±Ø¶ Ù…Ø¬Ø§Ø² */
      box-sizing: border-box; /* Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ù¾Ø¯ÛŒÙ†Ú¯ Ùˆ Ø¨Ø±Ø¯Ø± Ø±ÙˆÛŒ Ø¹Ø±Ø¶ Ø­Ø³Ø§Ø¨ Ø¨Ø´Ù† */
      text-align: center; /* Ù…ØªÙ† Ø¯Ø§Ø®Ù„Ø´ ÙˆØ³Ø·â€ŒÚ†ÛŒÙ† Ø¨Ø´Ù‡ */
    }
    
    /* Admin login is hidden by default, shown by JS only on title click */
    #adminLogin {
        display: none;
    }
    #cartSection {
      background: #fff; /* Ø¨Ú©Ú¯Ø±Ø§Ù†Ø¯ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ */
      padding: 15px;
      border-radius: 10px;
      text-align: right;
    }
    #address {
      margin-top: 10px;
    }
    .image-box {
      background: white;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px #01579B;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      width: calc(50% - 15px); /* Default for 2 items per row with gap */
      box-sizing: border-box; /* Include padding/border in width */
    }

    /* ØªØºÛŒÛŒØ±Ø§Øª: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©Ù„Ø§Ø³ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¸Ø±Ù ØªØµØ§ÙˆÛŒØ± Ø¯Ø§Ø®Ù„ Ú¯Ø§Ù„Ø±ÛŒ */
    .image-container-inner {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
      flex-grow: 1;
    }
    
    /* ØªØºÛŒÛŒØ±Ø§Øª: Ø§Ø³ØªØ§ÛŒÙ„ Ø¹Ù†ÙˆØ§Ù† Ú¯Ø±ÙˆÙ‡ */
    #gallery h2 {
      text-align: center;
      color: #1976D2;
      margin: 20px 0;
    }

    img {
      width: 100%;
      height: auto; /* Reverted to auto for original aspect ratio */
      border-radius: 8px;
      margin-bottom: 5px;
      cursor: pointer; /* Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† Ø§ÛŒÙ† Ø®Ø· Ø¨Ø±Ø§ÛŒ Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù† Ù‚Ø§Ø¨Ù„ÛŒØª Ú©Ù„ÛŒÚ© */
    }

    select, input[type="password"] {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
      width: calc(100% - 10px); /* Adjust width */
      box-sizing: border-box; /* Include padding/border in width */
    }
    
    .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 0;
        border-bottom: 1px dashed #eee;
    }
    .cart-item:last-child {
        border-bottom: none;
    }
    .quantity-control {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .cart-item-info {
        text-align: right;
        flex-grow: 1; /* Allow info section to take available space */
        margin-left: 10px; /* Space between info and controls */
    }
    .cart-item-actions {
        display: flex;
        align-items: center;
    }
    .cart-item-actions span {
        margin-left: 10px;
        font-weight: bold;
    }
    .cart-item-actions button {
      margin-left: 50px;
    }
    /* Controls at the top/bottom of gallery */
  .gallery-controls {
      display: flex;
      flex-direction: column; /* ØªØºÛŒÛŒØ± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ú†ÛŒØ¯Ù…Ø§Ù† Ø¹Ù…ÙˆØ¯ÛŒ */
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 10px 0;
      background-color: #BBDFF7;
      border-top: 2px solid #292C4B;
      box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05);
      z-index: 100;
}
  .group-selection-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-right: 0;
  }
    #gallery-bottom-controls {
        margin-top: auto;
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        border-bottom: none;
    }
    #gallery-top-controls {
        margin-bottom: 10px;
        border-top: none;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .gallery-controls button {
        margin: 0;
    }
    .in-cart-display { 
        font-size: 0.85em;
        color: #4FC3F7;
        font-weight: bold;
        margin-right: 0;
    }
    /* New style for the wrapper of home and cart buttons in gallery */
    .gallery-button-wrapper {
        display: flex;
        gap: 20px;
        align-items: center;
        flex-wrap: wrap;
    }
@media (max-width: 600px) {
    .image-box {
        width: calc(50% - 15px);
    }
   .gallery-controls {
    flex-direction: column;
    gap: 10px;
}
.gallery-button-wrapper, .group-selection-wrapper {
    width: calc(100% - 20px);
    justify-content: center;
    margin: 0;
}
.gallery-button-wrapper button {
    flex: 1 1 auto;
}
.group-selection-wrapper select {
    flex: 1 1 auto;
}
    .in-cart-display {
        text-align: center;
    }
}
  /* CSS Ø¨Ø±Ø§ÛŒ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ */
    #notification-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 300px;
    }
    
    .notification {
      background-color: #2196F3E6;
      color: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      font-size: 0.9em;
      direction: rtl;
    }
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .notification.hide {
        opacity: 0;
        transform: translateY(-20px);
    }
    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ ÙØ±Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø´ØªØ±ÛŒ */
    .customer-info-form {
      margin-top: 20px;
      text-align: right;
      background-color: #fffde7;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #eee;
    }
    .customer-info-form h4 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #333;
    }
    .customer-info-form label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .customer-info-form input[type="text"],
    .customer-info-form input[type="tel"],
    .customer-info-form textarea {
      width: calc(100% - 20px);
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-sizing: border-box;
    }
    .customer-info-form textarea {
      resize: vertical;
    }

    /* Modal for image zoom */
    .image-modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
    }
    .image-modal-content {
      position: relative;
      margin: auto;
      display: block;
      width: 90%;
      max-width: 900px;
      max-height: 90vh;
      object-fit: contain;
    }
    .close {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      transition: 0.3s;
      cursor: pointer;
    }
    .close:hover,
    .close:focus {
      color: #bbb;
      text-decoration: none;
      cursor: pointer;
    }
    .previous-orders-modal {
        display: none;
        position: fixed;
        z-index: 1002;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.4);
        justify-content: center;
        align-items: center;
    }
    .previous-orders-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 90%;
        max-width: 600px;
        border-radius: 10px;
        text-align: right;
        max-height: 80vh; /* ØªØºÛŒÛŒØ± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø§Ø±ØªÙØ§Ø¹ */
        overflow-y: auto; /* ØªØºÛŒÛŒØ± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø§Ø³Ú©Ø±ÙˆÙ„ */
    }
    .previous-order-item {
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
        margin-bottom: 10px;
    }
    .previous-order-item:last-child {
        border-bottom: none;
    }
    .previous-order-item h4 {
        color: #2196f3;
        margin-top: 0;
    }
    .previous-order-item button {
        margin-top: 10px;
        background-color: #4CAF50;
    }
    .previous-order-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      justify-content: flex-end;
    }
    .previous-order-buttons button.delete-btn {
      background-color: #f44336;
    }
    .cart-icon {
      width: 20px;
      height: 20px;
      vertical-align: middle;
      margin-right: 5px;
    }
    
  </style>
  
</head>
<body>

<div id="particles-js"></div>

<div id="mainSection">
  <div class="main-title-container">
    <img src="https://akbari5561.github.io/PosterIran/icons/apple-touch-icon-180x180.png" alt="Poster Iran Logo" class="header-logo"> <h1>Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù†</h1>
    <p id="subtitle">Ú†Ø§Ù¾ Ø§Ù†ÙˆØ§Ø¹ Ù¾ÙˆØ³ØªØ±Ù‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</p>
  </div>
  <div id="address">
    <p>ØªÙ‡Ø±Ø§Ù† : Ø®ÛŒØ§Ø¨Ø§Ù† Ù¾Ø§Ù†Ø²Ø¯Ù‡ Ø®Ø±Ø¯Ø§Ø¯</p>
    <p>Ø¨Ø§Ø²Ø§Ø± Ø¢Ù‡Ù†Ú¯Ø±Ø§Ù† ØŒ Ú©ÙˆÚ†Ù‡ Ù…Ø³Ø¬Ø¯ Ø¬Ø§Ù…Ø¹</p>
    <p>Ù¾Ø§Ø³Ø§Ú˜ Ú©Ø§ØºØ° Ùˆ ØªØ­Ø±ÛŒØ± ØŒ Ø²ÛŒØ±Ø²Ù…ÛŒÙ† Ø§ÙˆÙ„  Ù¾Ù„Ø§Ú©Û·Û´</p>
    <p> <a href="https://maps.google.com/?cid=1396884775989221050&g_mp=CiVnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLkdldFBsYWNl" target="_blank" style="text-decoration: none; color: #2196f3; font-weight: bold;">  (Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø± Ù†Ù‚Ø´Ù‡)</a></p>
    <p>ØªÙ„ÙÙ€Ù† : Û°Û²Û±ÛµÛµÛ¶Û±Û±Û¸Û·Ûµ</p>
    <p>Ù…ÙˆØ¨Ø§ÛŒÙ„ : Û°Û¹Û°Û±Û°Û±Û¹ÛµÛ¸Û¸Ûµ</p>
  </div>
  <div id="loginSection">
    <button id="enterAsUserBtn">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú¯Ø§Ù„Ø±ÛŒ</button>
    <button id="showCartBtn">
        <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
            <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
        </svg>
        Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ 
    </button>
  </div>
  <div id="clearCartButtonSection">
    <button id="clearCartMainBtn" class="clear-cart-btn">ØªÙˆØ¬Ù‡: Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø¯Ø§Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„ Ø§Ø³Øª. Ø¨Ø±Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø³ÙØ§Ø±Ø´ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ø±ÙˆÛŒØ¯ ÛŒØ§ Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯ØŒ Ø¢Ù† Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯.</button>
</div>
</div>

<div id="adminLogin">
  <input type="password" id="adminPassword" placeholder="Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†">
  <button id="loginAsAdminBtn">ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</button>
</div>

<div id="gallery">
  <div id="imagesContainer" class="image-container"></div>
  <div id="gallery-bottom-controls" class="gallery-controls">
    <div class="group-selection-wrapper"> <label for="bottomGroupSelect">Ø§Ù†ØªØ®Ø§Ø¨ Ú¯Ø±ÙˆÙ‡ ï¸:</label>
      <select id="bottomGroupSelect" class="group-select-fixed">
        <option value="1" selected>Ø³Ø§ÛŒØ² Û²Û¹Ã—Û²Û± Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
        <option value="2">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
        <option value="3">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
        <option value="4">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
        <option value="5">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÙˆÙˆÛŒâ€ŒØ¯Ø§Ø±</option>
        <option value="6">Ø³Ø§ÛŒØ± Ù…Ø­ØµÙˆÙ„Ø§Øª</option>
      </select>
    </div>
    <div class="gallery-button-wrapper">
        <button id="showHomeGalleryBtn" onclick="showScreen('main')">
            <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
                <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
            </svg>
            ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
        </button>
        <button id="showCartGalleryBtn">
            <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ 
        </button>
    </div>
</div> </div>
<div id="cartSection">
  <h3>
    <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
    </svg>
    Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ 
  </h3>
  <div id="cartList"></div>
  <p id="totalPrice" style="font-weight: bold; font-size: 1.1em; margin-top: 15px;"></p>

  <div class="customer-info-form">
    <h4>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø´ØªØ±ÛŒ:</h4>
    <label for="customerName">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</label>
    <input type="text" id="customerName" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>

    <label for="customerPhone">Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„:</label>
    <input type="tel" id="customerPhone" placeholder="Û°Û¹Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹" required pattern="09[0-9]{9}" inputmode="numeric">

    <label for="customerAddress">Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù…Ù„ ØªØ­ÙˆÛŒÙ„:</label>
    <textarea id="customerAddress" placeholder="Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ØŒ Ø´Ø§Ù…Ù„ Ø§Ø³ØªØ§Ù†ØŒ Ø´Ù‡Ø±ØŒ Ø®ÛŒØ§Ø¨Ø§Ù†ØŒ Ú©ÙˆÚ†Ù‡ØŒ Ù¾Ù„Ø§Ú©ØŒ ÙˆØ§Ø­Ø¯ Ùˆ Ú©Ø¯ Ù¾Ø³ØªÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)" rows="4" required></textarea>
  </div>

  <button id="submitOrderBtn" style="background-color: #25D366;">Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´ Ø¨Ø§ ÙˆØ§ØªØ³â€ŒØ¢Ù¾</button>
  <button id="clearCartCartBtn" class="clear-cart-btn">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ù„ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
  <button id="showGalleryCartBtn" style="background-color: #2196f3;">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ú¯Ø§Ù„Ø±ÛŒ ğŸ”™ </button>
  <button id="showPreviousOrdersBtn"style="background-color: #9C27B0;">Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ ğŸ“¦</button>
  
</div>

<div id="image-modal" class="image-modal">
  <span class="close" onclick="closeImageModal()">Ã—</span>
  <img class="image-modal-content" id="modal-image">
</div>

<div id="previous-orders-modal" class="previous-orders-modal">
    <div class="previous-orders-content">
        <span class="close" onclick="closePreviousOrdersModal()">Ã—</span>
        <h3>Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ</h3>
        <div id="previousOrdersList"></div>
    </div>
</div>

<div id="notification-container"></div>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
/* particles.js config */
particlesJS('particles-js', {
  "particles": {
    "number": {
      "value": 80,
      "density": {
        "enable": true,
        "value_area": 800
      }
    },
    "color": {
      "value": "#ffffff"
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {
        "src": "img/github.svg",
        "width": 100,
        "height": 100
      }
    },
    "opacity": {
      "value": 0.5,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 3,
      "random": true,
      "anim": {
        "enable": false,
        "speed": 40,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": true,
      "distance": 150,
      "color": "#ffffff",
      "opacity": 0.4,
      "width": 1
    },
    "move": {
      "enable": true,
      "speed": 0.5,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      "onhover": {
        "enable": true,
        "mode": "repulse"
      },
      "onclick": {
        "enable": true,
        "mode": "push"
      },
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 400,
        "line_linked": {
          "opacity": 1
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
});
</script>

<script>
const groupInfo = {
    1: {
        name: "Ø³Ø§ÛŒØ² Û²Û¹Ã—Û²Û± Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾",
        price: 100000,
        images: [
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ" },
            { filename: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª.jpg", name: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª" },
            { filename: "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", name: "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ…" },
            { filename: "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", name: "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ…" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„" },
            { filename: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø§ÙÙ‚ÛŒ).jpg", name: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø§ÙÙ‚ÛŒ)" },
            { filename: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø¹Ù…ÙˆØ¯ÛŒ).jpg", name: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø¹Ù…ÙˆØ¯ÛŒ)" },
            { filename: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø§ÙÙ‚ÛŒ).jpg", name: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø§ÙÙ‚ÛŒ)" },
            { filename: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø¹Ù…ÙˆØ¯ÛŒ).jpg", name: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø¹Ù…ÙˆØ¯ÛŒ)" },
            { filename: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ù¾Ø§ÛŒÙ‡ Ø³ÙˆÙ….jpg", name: "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ù¾Ø§ÛŒÙ‡ Ø³ÙˆÙ…" },
            { filename: "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ.jpg", name: "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ" },
            { filename: "Ø¶Ø±Ø¨ Ùˆ ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨.jpg", name: "Ø¶Ø±Ø¨ Ùˆ ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨" },
            { filename: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", name: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±" },
        ]
    },
    2: {
        name: "Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾",
        price: 100000,
        images: [
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 350.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 350" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 351.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 351" },
        ]
    },
    3: {
        name: "Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾",
        price: 200000,
        images: [
            { filename: "Ø§Ø¹Ø¯Ø§Ø¯ Ù‡Ù…Ø±Ø§Ù‡ Ø³Ø§Ø¹Øª Ùˆ Ù…Ø­ÙˆØ±.jpg", name: "Ø§Ø¹Ø¯Ø§Ø¯ Ù‡Ù…Ø±Ø§Ù‡ Ø³Ø§Ø¹Øª Ùˆ Ù…Ø­ÙˆØ±" },
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ" },
            { filename: "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", name: "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ…" },
            { filename: "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", name: "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ…" },
            { filename: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", name: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹ Ùˆ ØªÙØ±ÛŒÙ‚.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹ Ùˆ ØªÙØ±ÛŒÙ‚" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„" },
            { filename: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª.jpg", name: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª" },
        ]
    },
    4: {
        name: "Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾",
        price: 200000,
        images: [
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¨Ø¯ÙˆÙ† Ø´Ú©Ù„.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¨Ø¯ÙˆÙ† Ø´Ú©Ù„" },
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ  Ø´Ú©Ù„ Ø¯Ø§Ø±.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ  Ø´Ú©Ù„ Ø¯Ø§Ø±" },
            { filename: "Ø§Ø¹Ø¯Ø§Ø¯ 1 ØªØ§ 100.jpg", name: "Ø§Ø¹Ø¯Ø§Ø¯ 1 ØªØ§ 100" },
            { filename: "Ø§Ø¹Ø¯Ø§Ø¯ Ø¯Ù‡ Ø¯Ù‡ÛŒ.jpg", name: "Ø§Ø¹Ø¯Ø§Ø¯ Ø¯Ù‡ Ø¯Ù‡ÛŒ" },
            { filename: "Ø§Ù„ÙØ¨Ø§ÛŒ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", name: "Ø§Ù„ÙØ¨Ø§ÛŒ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹" },
            { filename: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨.jpg", name: "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨" },
            { filename: "Ø¬Ø¯ÙˆÙ„ ØªÙ‚Ø³ÛŒÙ….jpg", name: "Ø¬Ø¯ÙˆÙ„ ØªÙ‚Ø³ÛŒÙ…" },
            { filename: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", name: "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±" },
        ]
    },
    5: {
        name: "Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÙˆÙˆÛŒâ€ŒØ¯Ø§Ø±",
        price: 250000,
        images: [
            { filename: "Ø´Ù‡Ø±Ú© Ø§Ù„ÙØ¨Ø§.jpg", name: "Ø´Ù‡Ø±Ú© Ø§Ù„ÙØ¨Ø§" },
            { filename: "Ø¢Ù†Ø§ØªÙˆÙ…ÛŒ Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù†.jpg", name: "Ø¢Ù†Ø§ØªÙˆÙ…ÛŒ Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù†" },
            { filename: "Ø¨Ø¯Ù† Ù…Ù†.jpg", name: "Ø¨Ø¯Ù† Ù…Ù†" },
            { filename: "Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§ Ùˆ Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ.jpg", name: "Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§ Ùˆ Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ" },
            { filename: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† ÙˆØ³Ø§Ø¹Øª.jpg", name: "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† ÙˆØ³Ø§Ø¹Øª" },
            { filename: "Ø¶Ø±Ø¨ ØªÙ…Ø±ÛŒÙ†ÛŒ Ø³ØªÙˆÙ†ÛŒ.jpg", name: "Ø¶Ø±Ø¨ ØªÙ…Ø±ÛŒÙ†ÛŒ Ø³ØªÙˆÙ†ÛŒ" },
            { filename: "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ.jpg", name: "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ" },
            { filename: "Ù…Ù†Ø¸ÙˆÙ…Ù‡ Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ.jpg", name: "Ù…Ù†Ø¸ÙˆÙ…Ù‡ Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ" },
            { filename: "Ù†Ù‚Ø´Ù‡ Ø§ÛŒØ±Ø§Ù†.jpg", name: "Ù†Ù‚Ø´Ù‡ Ø§ÛŒØ±Ø§Ù†" },
            { filename: "Ù†Ù‚Ø´Ù‡ Ø¬Ù‡Ø§Ù†.jpg", name: "Ù†Ù‚Ø´Ù‡ Ø¬Ù‡Ø§Ù†" },
        ]
    },
    6: {
        name: "Ø³Ø§ÛŒØ± Ù…Ø­ØµÙˆÙ„Ø§Øª",
        type: "variable-count",
        defaultQtyMultiplier: 12,
        images: [
            { filename: "ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø§Ù„ÙØ¨Ø§.jpeg", name: "ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø§Ù„ÙØ¨Ø§", price: 180000 },
            { filename: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ú©ÙˆÚ†Ú© Ø§Ù„ÙØ¨Ø§.jpeg", name: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ú©ÙˆÚ†Ú© Ø§Ù„ÙØ¨Ø§", price: 220000 },
            { filename: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ú©ÙˆÚ†Ú© Ø¶Ø±Ø¨.jpeg", name: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ú©ÙˆÚ†Ú© Ø¶Ø±Ø¨", price: 220000 },
            { filename: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø¶Ø±Ø¨.jpeg", name: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø¶Ø±Ø¨", price: 280000 },
            { filename: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ù„ÙØ¨Ø§.jpeg", name: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ù„ÙØ¨Ø§", price: 280000 },
            { filename: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø¯ÙˆØ³ØªÛŒ.jpeg", name: "Ø¯ÙØªØ±Ú†Ù‡ Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø¯ÙˆØ³ØªÛŒ", price: 280000 },
            { filename: "ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø§Ø¹Ø¯Ø§Ø¯.jpeg", name: "ÙÙ„Ø´ Ú©Ø§Ø±Øª Ø§Ø¹Ø¯Ø§Ø¯", price: 240000, qtyMultiplier: 50 },
            { filename: "Ø§Ø³ØªÛŒÚ©Ø± A4.jpeg", name: "Ø§Ø³ØªÛŒÚ©Ø± A4", price: 55000, qtyMultiplier: 100 },
        ],
    }
};
const allowedQuantities = [0, 10, 20, 30, 50, 100, 200, 300, 400, 500];
let cart = new Map(JSON.parse(localStorage.getItem('cart') || '[]'));
const MAX_QTY_OTHER_PRODUCTS = 1200;

const screens = {
  main: document.getElementById('mainSection'),
  gallery: document.getElementById('gallery'),
  cart: document.getElementById('cartSection')
};

function showScreen(screenName) {
  for (let key in screens) {
    screens[key].style.display = 'none';
  }
  screens[screenName].style.display = 'flex';
  
  if (history.state === null || history.state.screen !== screenName) {
    history.pushState({ screen: screenName }, '', `#${screenName}`);
  }

  if (screenName === 'gallery') {
    const currentGroupId = document.getElementById('bottomGroupSelect').value;
    loadGroup(currentGroupId);
  } else if (screenName === 'cart') {
    renderCartList();
    loadCustomerInfo();
  }
  checkCartState();
}

window.addEventListener('popstate', (event) => {
    if (event.state && event.state.screen) {
        for (let key in screens) {
            screens[key].style.display = 'none';
        }
        screens[event.state.screen].style.display = 'flex';
        if (event.state.screen === 'gallery') {
            const currentGroupId = document.getElementById('bottomGroupSelect').value;
            loadGroup(currentGroupId);
        } else if (event.state.screen === 'cart') {
            renderCartList();
            loadCustomerInfo();
        }
        checkCartState();
    } else {
        showScreen('main');
    }
});

function showNotification(message) {
    const container = document.getElementById('notification-container');
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.textContent = message;
    container.appendChild(notification);
    void notification.offsetWidth;
    notification.classList.add('show');
    
    setTimeout(() => {
        notification.classList.remove('show');
        notification.classList.add('hide');
        setTimeout(() => {
            notification.remove();
        }, 500);
    }, 4000);
}

// ** Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ **
function showWelcomeNotification(message) {
    showNotification(message);
}

function generateQuantityOptions(selectedQty, qtyMultiplier = 1, isOtherProductsGroup = false) {
    let optionsHtml = '';
    const maxQtyForOtherProducts = MAX_QTY_OTHER_PRODUCTS;

    if (isOtherProductsGroup) {
        optionsHtml += `<option value="0" ${selectedQty === 0 ? 'selected' : ''}>0</option>`;
        for (let i = qtyMultiplier; i <= maxQtyForOtherProducts; i += qtyMultiplier) {
            optionsHtml += `<option value="${i}" ${i === selectedQty ? 'selected' : ''}>${i}</option>`;
        }
    } else if (qtyMultiplier > 1) {
        optionsHtml += `<option value="0" ${selectedQty === 0 ? 'selected' : ''}>0</option>`;
        for (let i = qtyMultiplier; i <= 5000; i += qtyMultiplier) {
            optionsHtml += `<option value="${i}" ${i === selectedQty ? 'selected' : ''}>${i}</option>`;
        }
    } else {
        allowedQuantities.forEach(qty => {
            optionsHtml += `<option value="${qty}" ${qty === selectedQty ? 'selected' : ''}>${qty}</option>`;
        });
    }
    return optionsHtml;
}

function loadGroup(groupId) {
    const container = document.getElementById("imagesContainer");

    const info = groupInfo[groupId];
    if (!info) {
        console.error(`Group with ID ${groupId} not found. Cannot load images.`);
        container.innerHTML = "";
        return;
    }

    container.innerHTML = `<h2>${info.name}</h2>
                           <div class="image-container-inner"></div>`;
    const imagesContainerInner = document.querySelector(".image-container-inner");
    const isVariableCountGroup = info.type === 'variable-count';
    const isOtherProductsGroup = (groupId === '6');

    info.images.forEach(item => {
        const itemPrice = item.price || info.price;
        const filename = item.filename;
        const itemName = item.name;
        const imagePath = `Image/${info.name}/${filename}`;
        const itemUniqueId = `${groupId}-${filename}`;
        const currentCartItem = cart.has(itemUniqueId) ? cart.get(itemUniqueId) : null;
        const initialQty = currentCartItem ? currentCartItem.qty : 0;
        const qtyMultiplier = isVariableCountGroup ? (item.qtyMultiplier || info.defaultQtyMultiplier || 1) : 1;
        
        const box = document.createElement("div");
        box.className = "image-box";
        box.innerHTML = `
            <img src="${imagePath}" alt="${itemName}" onclick="openImageModal('${imagePath}')">
            <p style="font-weight: bold; margin-bottom: 5px;">${itemName}</p>
            <p style="color: #4CAF50; font-weight: bold;">Ù‚ÛŒÙ…Øª: ${itemPrice.toLocaleString()} Ø±ÛŒØ§Ù„</p>
            <div style="display: flex; flex-direction: column; align-items: center; margin-top: 10px; justify-content: center;">
                <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
                    <label for="qty-select-${itemUniqueId}">ØªØ¹Ø¯Ø§Ø¯ :</label>
                    <select id="qty-select-${itemUniqueId}" class="quantity-select">
                        ${generateQuantityOptions(initialQty, qtyMultiplier, isOtherProductsGroup)}
                    </select>
                </div>
                <p id="in-cart-display-${itemUniqueId}" class="in-cart-display" style="margin-top: 5px;">Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: ${initialQty} Ø¹Ø¯Ø¯</p>
            </div>
        `;
        imagesContainerInner.appendChild(box);
    });
    
    // Attach event listeners to newly created selects
    info.images.forEach(item => {
        const itemUniqueId = `${groupId}-${item.filename}`;
        const qtySelect = document.getElementById(`qty-select-${itemUniqueId}`);
        if (qtySelect) {
            qtySelect.addEventListener('change', () => addToCart(groupId, item.filename));
        }
    });

    document.getElementById('gallery').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function addToCart(groupId, filename) {
    const info = groupInfo[groupId];
    const itemUniqueId = `${groupId}-${filename}`;
    
    const isVariableCountGroup = info.type === 'variable-count';
    const isOtherProductsGroup = (parseInt(groupId) === 6);
    
    const qtySelect = document.getElementById(`qty-select-${itemUniqueId}`);
    let selectedQty = parseInt(qtySelect.value);
    
    // Find the specific item in the group
    const itemInGroup = info.images.find(img => img.filename === filename);
    if (!itemInGroup) {
        console.error(`Item with filename ${filename} not found in group ${groupId}.`);
        return;
    }
    
    // Determine the price based on whether the item has its own price or uses the group price
    const itemPrice = itemInGroup.price || info.price;
    
    const qtyMultiplier = isVariableCountGroup ? (itemInGroup.qtyMultiplier || info.defaultQtyMultiplier) : 1;
    
    if (isNaN(selectedQty) || selectedQty < 0) {
        showNotification("Ù„Ø·ÙØ§ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹ØªØ¨Ø±ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.");
        selectedQty = cart.has(itemUniqueId) ? cart.get(itemUniqueId).qty : 0;
        qtySelect.value = selectedQty;
        return;
    }
    
    if (isVariableCountGroup && (selectedQty % qtyMultiplier !== 0)) {
        showNotification(`Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ØŒ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§ÛŒØ¯ Ù…Ø¶Ø±Ø¨ÛŒ Ø§Ø² ${qtyMultiplier} Ø¨Ø§Ø´Ø¯.`);
        qtySelect.value = cart.has(itemUniqueId) ? cart.get(itemUniqueId).qty : 0;
        return;
    }
    
    if (isOtherProductsGroup && selectedQty > MAX_QTY_OTHER_PRODUCTS) {
        showNotification(`Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¬Ø§Ø² Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ú¯Ø±ÙˆÙ‡ "Ø³Ø§ÛŒØ± Ù…Ø­ØµÙˆÙ„Ø§Øª" ${MAX_QTY_OTHER_PRODUCTS} Ø¹Ø¯Ø¯ Ø§Ø³Øª.`);
        selectedQty = MAX_QTY_OTHER_PRODUCTS;
        qtySelect.value = selectedQty;
    }
    
    const previousQty = cart.has(itemUniqueId) ? cart.get(itemUniqueId).qty : 0;
    
    if (selectedQty === 0) {
        if (cart.has(itemUniqueId)) {
            removeFromCart(itemUniqueId, false);
        }
    } else {
        cart.set(itemUniqueId, {
            groupId: groupId,
            filename: filename,
            groupName: info.name,
            name: itemInGroup.name,
            price: itemPrice, // Correctly assigns the price
            qty: selectedQty
        });
        saveCart();
        
        if (selectedQty > previousQty) {
            showNotification(`${itemInGroup.name} Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`);
        } else if (selectedQty < previousQty) {
            showNotification(`ØªØ¹Ø¯Ø§Ø¯ ${itemInGroup.name} Ø¯Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ù‡ ${selectedQty} Ø¹Ø¯Ø¯ Ú©Ø§Ù‡Ø´ ÛŒØ§ÙØª.`);
        } else {
            showNotification(`ØªØ¹Ø¯Ø§Ø¯ ${itemInGroup.name} Ø¯Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ ØªØºÛŒÛŒØ±ÛŒ Ù†Ú©Ø±Ø¯ Ùˆ ${selectedQty} Ø¹Ø¯Ø¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯.`);
        }
    }
    
    let inCartDisplayElement = document.getElementById(`in-cart-display-${itemUniqueId}`);
    
    if (inCartDisplayElement) {
        inCartDisplayElement.textContent = `Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: ${selectedQty} Ø¹Ø¯Ø¯`;
    }
    checkCartState();
}

function updateCartItemQuantityFromDropdown(selectElement, itemUniqueId) {
    const [groupId, filename] = itemUniqueId.split('-');
    const info = groupInfo[groupId];
    const isVariableCountGroup = info.type === 'variable-count';
    const isOtherProductsGroup = (parseInt(groupId) === 6);
    let itemInGroup;
    if (isVariableCountGroup) {
      itemInGroup = info.images.find(img => img.filename === filename);
    } else {
      itemInGroup = info.images.find(img => img.filename === filename);
    }

    let newQty = parseInt(selectElement.value);

    if (isNaN(newQty) || newQty < 0) {
        console.error("Invalid quantity selected from dropdown.");
        renderCartList();
        return;
    }
    
    if (isOtherProductsGroup && newQty > MAX_QTY_OTHER_PRODUCTS) {
        showNotification(`Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¬Ø§Ø² Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ú¯Ø±ÙˆÙ‡ "Ø³Ø§ÛŒØ± Ù…Ø­ØµÙˆÙ„Ø§Øª" ${MAX_QTY_OTHER_PRODUCTS} Ø¹Ø¯Ø¯ Ø§Ø³Øª.`);
        newQty = MAX_QTY_OTHER_PRODUCTS;
        selectElement.value = newQty;
    }
    
    if (newQty === 0) {
        const itemToRemove = cart.get(itemUniqueId);
        if (itemToRemove) {
            removeFromCart(itemUniqueId, false);
        }
    } else {
        let item = cart.get(itemUniqueId);
        item.qty = newQty;
        cart.set(itemUniqueId, item);
        saveCart();
        renderCartList();
        showNotification(`ØªØ¹Ø¯Ø§Ø¯ ${itemInGroup.name} Ø¯Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨Ù‡ ${newQty} Ø¹Ø¯Ø¯ ØªØºÛŒÛŒØ± ÛŒØ§ÙØª.`);
    }
    checkCartState();
}

function removeFromCart(itemUniqueId, showConfirm = true) {
    const itemToRemove = cart.get(itemUniqueId);
    if (!itemToRemove) return;

    if (showConfirm && !confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø§Ø² Ø³Ø¨Ø¯ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
        return;
    }

    cart.delete(itemUniqueId);
    saveCart();
    renderCartList();
    showNotification(`${itemToRemove.name} Ø§Ø² Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø­Ø°Ù Ø´Ø¯.`);

    if (document.getElementById('gallery').style.display === 'flex') {
        const qtySelectInGallery = document.getElementById(`qty-select-${itemUniqueId}`);
        if (qtySelectInGallery) {
            qtySelectInGallery.value = 0;
            const inCartDisplayElement = document.getElementById(`in-cart-display-${itemUniqueId}`);
            if (inCartDisplayElement) {
                inCartDisplayElement.textContent = `Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: 0 Ø¹Ø¯Ø¯`;
            }
        }
    }
    checkCartState();
}

function clearCart() {
    if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ú©Ù„ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ')) {
        cart.clear();
        saveCart();
        renderCartList();
        showNotification('Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ù¾Ø§Ú© Ø´Ø¯.');
        if (document.getElementById('gallery').style.display === 'flex') {
            loadGroup(document.getElementById('bottomGroupSelect').value);
        }
        checkCartState();
    }
}

function calculateDiscountPercentage(totalAmount) {
    if (totalAmount >= 1000000000) return 0.00;
    else if (totalAmount >= 900000000) return 0.00;
    else if (totalAmount >= 800000000) return 0.00;
    else if (totalAmount >= 700000000) return 0.00;
    else if (totalAmount >= 600000000) return 0.00;
    else if (totalAmount >= 500000000) return 0.00;
    else if (totalAmount >= 400000000) return 0.00;
    else if (totalAmount >= 300000000) return 0.00;
    else if (totalAmount >= 200000000) return 0.00;
    else return 0;
}

function renderCartList() {
    const list = document.getElementById("cartList");
    const totalDisplay = document.getElementById("totalPrice");
    list.innerHTML = "";
    let grouped = {};
    let groupedSummaries = {};
    let totalSumBeforeDiscount = 0;

    if (cart.size === 0) {
        list.innerHTML = "<p>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>";
        totalDisplay.textContent = `Ù…Ø¨Ù„Øº Ú©Ù„: 0 Ø±ÛŒØ§Ù„`;
        return;
    }

    cart.forEach(item => {
        if (!grouped[item.groupName]) grouped[item.groupName] = [];
        grouped[item.groupName].push(item);
        totalSumBeforeDiscount += item.qty * item.price;

        if (!groupedSummaries[item.groupName]) {
            groupedSummaries[item.groupName] = {
                totalQty: 0,
                totalPrice: 0
            };
        }
        groupedSummaries[item.groupName].totalQty += item.qty;
        groupedSummaries[item.groupName].totalPrice += item.qty * item.price;
    });

    for (let groupName in grouped) {
    list.innerHTML += `<h4 style="margin-top: 45px; margin-bottom: 0px; text-align: right; border-bottom: 1px dashed #eee; padding-bottom: 5px; color: #4CAF50;">${groupName}</h4>`;
    grouped[groupName].forEach(item => {
                const itemUniqueId = `${item.groupId}-${item.filename}`;
            
            const group = groupInfo[item.groupId]; 
            let itemDetail = null;
            if (group.type === 'variable-count') {
                itemDetail = group.images.find(img => img.filename === item.filename);
            }
            const qtyMultiplierForCartItem = itemDetail ? (itemDetail.qtyMultiplier || group.defaultQtyMultiplier || 1) : 1; 
            const isOtherProductsGroup = (parseInt(item.groupId) === 6);

            const itemDiv = document.createElement("div");
            itemDiv.className = "cart-item";
            itemDiv.innerHTML = `
                <div class="cart-item-info">
                    <p style="font-weight: bold; margin-bottom: 3px;"> ${item.name}</p>
                </div>
                <div class="quantity-control">
                    <select id="cart-qty-select-${itemUniqueId}" class="quantity-select"
                                onchange="updateCartItemQuantityFromDropdown(this, '${itemUniqueId}')">
                            ${generateQuantityOptions(item.qty, qtyMultiplierForCartItem, isOtherProductsGroup)} </select>
                   
                </div>
            `;
            list.appendChild(itemDiv);
        });
    }

    list.innerHTML += `<hr style="margin: 15px 0; border: 0; border-top: 1px dashed #ccc;">`;
    list.innerHTML += `<h3 style="margin-bottom: 10px;">Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´ Ø¨Ø± Ø§Ø³Ø§Ø³ Ú¯Ø±ÙˆÙ‡:</h3>`;
    for (let groupName in groupedSummaries) {
        const summary = groupedSummaries[groupName];
        list.innerHTML += `
            <div style="background-color: #e8f5e9; padding: 8px; margin-bottom: 5px; border-radius: 5px; text-align: right;">
                <p style="font-weight: bold; margin: 0;">${groupName}:</p>
                <p style="margin: 0; font-size: 0.9em;">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„: ${summary.totalQty} Ø¹Ø¯Ø¯ - Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÛŒÙ…Øª: ${summary.totalPrice.toLocaleString()} Ø±ÛŒØ§Ù„</p>
            </div>
        `;
    }
    list.innerHTML += `<hr style="margin: 15px 0; border: 0; border-top: 1px dashed #ccc;">`;

    list.innerHTML += `
        <div style="padding: 8px; margin-bottom: 5px; border-radius: 5px; text-align: right; background-color: #e0f2f7;">
            <p style="font-weight: bold; margin: 0;">Ù…Ø¨Ù„Øº Ú©Ù„ : ${totalSumBeforeDiscount.toLocaleString()} Ø±ÛŒØ§Ù„</p>
        </div>
    `;

    const discountRate = calculateDiscountPercentage(totalSumBeforeDiscount);
    const discountAmount = totalSumBeforeDiscount * discountRate;
    let totalSumAfterDiscount = totalSumBeforeDiscount - discountAmount;

    if (discountAmount > 0) {
        list.innerHTML += `
            <div style="padding: 8px; margin-bottom: 5px; border-radius: 5px; text-align: right; background-color: #ffe0b2;">
                <p style="font-weight: bold; margin: 0; color: #e65100;">ğŸ ØªØ®ÙÛŒÙ (${discountAmount.toLocaleString()} Ø±ÛŒØ§Ù„)</p>
                <p style="margin: 0; font-size: 0.9em;">Ù…Ø¨Ù„Øº Ù¾Ø³ Ø§Ø² ØªØ®ÙÛŒÙ: ${totalSumAfterDiscount.toLocaleString()} Ø±ÛŒØ§Ù„</p>
            </div>
            <hr style="margin: 15px 0; border: 0; border-top: 1px dashed #ccc;">
        `;
    }

    const baseShippingThreshold = 100000000; 
    const costPerThreshold = 600000; Â  Â  
    let calculatedShippingCost = 0;
    let shippingDisplayMessage = "";
    
    if (totalSumAfterDiscount === 0) {
        calculatedShippingCost = 0;
        shippingDisplayMessage = `\nğŸšš Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ø§Ø±Ø¨Ø±ÛŒ: 0 Ø±ÛŒØ§Ù„`;
    } else {
        const numberOfThresholds = Math.ceil(totalSumAfterDiscount / baseShippingThreshold);
        calculatedShippingCost = numberOfThresholds * costPerThreshold;
        shippingDisplayMessage = `\nğŸšš Ù‡Ø²ÛŒÙ†Ù‡â€ŒØ¨Ø§Ø±Ø¨Ø±ÛŒâ€Œ(â€Œ${numberOfThresholds} Ø¨Ø³ØªÙ‡) : ${calculatedShippingCost.toLocaleString()} Ø±ÛŒØ§Ù„ `;
    }

    const finalTotalWithShipping = totalSumAfterDiscount + calculatedShippingCost;

    list.innerHTML += `
        <div style="padding: 8px; margin-top: 10px; border-radius: 5px; text-align: right;">
            <p style="font-weight: bold; margin: 0;">${shippingDisplayMessage}</p>
        </div>
    `;
    totalDisplay.textContent = `ğŸ’° Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª : ${finalTotalWithShipping.toLocaleString()} Ø±ÛŒØ§Ù„`;
    checkCartState();
}

function saveCart() {
  localStorage.setItem('cart', JSON.stringify(Array.from(cart.entries())));
}

const orderPhoneNumber = "989010195885";

function validateCustomerInfo() {
    const customerName = document.getElementById('customerName').value.trim();
    const customerPhone = document.getElementById('customerPhone').value.trim();
    const customerAddress = document.getElementById('customerAddress').value.trim();

    if (!customerName || !customerPhone || !customerAddress) {
        showNotification('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒØŒ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ùˆ Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù…Ù„ ØªØ­ÙˆÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return false;
    }
    
    localStorage.setItem('customerName', customerName);
    localStorage.setItem('customerPhone', customerPhone);
    localStorage.setItem('customerAddress', customerAddress);
    return true;
}

function saveOrderToHistory(orderId) {
    const currentCartArray = Array.from(cart.values());
    if (currentCartArray.length === 0) return;

    let ordersHistory = JSON.parse(localStorage.getItem('previousOrders') || '[]');

    const totalAmountBeforeDiscount = currentCartArray.reduce((acc, item) => acc + (item.qty * item.price), 0);
    const discountRate = calculateDiscountPercentage(totalAmountBeforeDiscount);
    const discountAmount = totalAmountBeforeDiscount * discountRate;
    const totalAmountAfterDiscount = totalAmountBeforeDiscount - discountAmount;
    
    const baseShippingThreshold = 100000000;
    const costPerThreshold = 600000;
    let calculatedShippingCost = 0;
    if (totalAmountAfterDiscount > 0) {
        const numberOfThresholds = Math.ceil(totalAmountAfterDiscount / baseShippingThreshold);
        calculatedShippingCost = numberOfThresholds * costPerThreshold;
    }

    const finalTotalAmount = totalAmountAfterDiscount + calculatedShippingCost;

    const newOrder = {
        id: orderId,
        date: new Date().toLocaleString('fa-IR'),
        items: currentCartArray,
        totalPrice: finalTotalAmount,
        totalPriceBeforeDiscount: totalAmountBeforeDiscount,
        discount: discountAmount,
        shipping: calculatedShippingCost,
        customerInfo: {
            name: document.getElementById('customerName').value,
            phone: document.getElementById('customerPhone').value,
            address: document.getElementById('customerAddress').value
        }
    };
    ordersHistory.push(newOrder);
    localStorage.setItem('previousOrders', JSON.stringify(ordersHistory));
}

function generateOrderMessage(orderId) {
    const orderDate = new Date().toLocaleString('fa-IR');
    let message = `ğŸ—“ï¸ ØªØ§Ø±ÛŒØ®: ${orderDate}\n`;
    message += `ğŸ›ï¸ Ø³ÙØ§Ø±Ø´ Ù…Ù† - Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´: ${orderId}\n`;
    const customerName = document.getElementById('customerName').value.trim();
    const customerPhone = document.getElementById('customerPhone').value.trim();
    const customerAddress = document.getElementById('customerAddress').value.trim();
    
    message += `\nğŸ‘¤ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ: ${customerName}\n`;
    message += `ğŸ“± Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„: ${customerPhone}\n`;
    message += `ğŸ“ Ø¢Ø¯Ø±Ø³ ØªØ­ÙˆÛŒÙ„: ${customerAddress}\n`;

    let totalAmountBeforeDiscount = 0;
    let groupedItems = {};
    let groupedSummaries = {};

    cart.forEach(item => {
        if (!groupedItems[item.groupName]) groupedItems[item.groupName] = [];
        groupedItems[item.groupName].push(item);
        totalAmountBeforeDiscount += item.qty * item.price;
        if (!groupedSummaries[item.groupName]) {
            groupedSummaries[item.groupName] = { totalQty: 0, totalPrice: 0 };
        }
        groupedSummaries[item.groupName].totalQty += item.qty;
        groupedSummaries[item.groupName].totalPrice += item.qty * item.price;
    });

    message += "\nğŸ”†ğŸ”… Ø¬Ø²Ø¦ÛŒØ§Øª  Ø³ÙØ§Ø±Ø´\n";
    for (let groupName in groupedItems) {
        message += `\nâ€¢ ${groupName}  :\n`;
        groupedItems[groupName].forEach(item => {
            message += ` Â - ${item.name} - ØªØ¹Ø¯Ø§Ø¯: ${item.qty} Ø¹Ø¯Ø¯\n`;
        });
    }

    message += "               ---------------------------------------\n";
    message += "\nğŸ”¶ğŸ”¸ Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´ Ø¨Ø± Ø§Ø³Ø§Ø³ Ú¯Ø±ÙˆÙ‡\n";
    for (let groupName in groupedSummaries) {
        const summary = groupedSummaries[groupName];
        message += `* ${groupName}: ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ ${summary.totalQty} Ø¹Ø¯Ø¯ - Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÛŒÙ…Øª: ${summary.totalPrice.toLocaleString()} Ø±ÛŒØ§Ù„\n`;
    }
    message += "               ---------------------------------------\n";

    const discountRate = calculateDiscountPercentage(totalAmountBeforeDiscount);
    const discountAmount = totalAmountBeforeDiscount * discountRate;
    const totalAmountAfterDiscount = totalAmountBeforeDiscount - discountAmount;

    message += `\nğŸ’µ Ù…Ø¨Ù„Øº Ú©Ù„ : ${totalAmountBeforeDiscount.toLocaleString()} Ø±ÛŒØ§Ù„`;
    if (discountAmount > 0) {
        message += `\nğŸ ØªØ®ÙÛŒÙ : ${discountAmount.toLocaleString()} Ø±ÛŒØ§Ù„`;
        message += `\nğŸ’µ Ù…Ø¨Ù„Øº Ù¾Ø³ Ø§Ø² ØªØ®ÙÛŒÙ: ${totalAmountAfterDiscount.toLocaleString()} Ø±ÛŒØ§Ù„`;
    }

    const baseShippingThreshold = 100000000;
    const costPerThreshold = 600000;
    let calculatedShippingCost = 0;
    let shippingMessage = "";
    
    if (totalAmountAfterDiscount === 0) {
        calculatedShippingCost = 0;
        shippingMessage = "\nğŸšš Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ø§Ø±Ø¨Ø±ÛŒ: 0 Ø±ÛŒØ§Ù„";
    } else {
        const numberOfThresholds = Math.ceil(totalAmountAfterDiscount / baseShippingThreshold);
        calculatedShippingCost = numberOfThresholds * costPerThreshold;
        shippingMessage = `\nğŸšš Ù‡Ø²ÛŒÙ†Ù‡â€ŒØ¨Ø§Ø±Ø¨Ø±ÛŒâ€Œ(â€Œ${numberOfThresholds} Ø¨Ø³ØªÙ‡) : ${calculatedShippingCost.toLocaleString()} Ø±ÛŒØ§Ù„ `;
    }

    const finalTotalAmountWithShipping = totalAmountAfterDiscount + calculatedShippingCost;

    message += shippingMessage;
    message += `\nğŸ’° Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª: ${finalTotalAmountWithShipping.toLocaleString()} Ø±ÛŒØ§Ù„`;
    message += `\n\nâœ… Â Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯ . Ø¯Ø± Ø§Ø³Ø±Ø¹ ÙˆÙ‚Øª Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ùˆ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ù„Ø§Ø²Ù… Ø¨Ø§ Ø´Ù…Ø§ ØµÙˆØ±Øª Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯.`;
    return message;
}


function submitOrderWithWhatsApp() {
    if (cart.size === 0) {
        showNotification('Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.');
        return;
    }
    if (!validateCustomerInfo()) {
        return;
    }
    
    const orderId = Date.now().toString().slice(-4);
    saveOrderToHistory(orderId);
    const message = generateOrderMessage(orderId);
    const whatsappUrl = `https://wa.me/${orderPhoneNumber}?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');

    cart.clear();
    saveCart();
    renderCartList();
    showNotification('Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø«Ø¨Øª Ùˆ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ù¾Ø§Ú© Ø´Ø¯.');
    if (document.getElementById('gallery').style.display === 'flex') {
        loadGroup(document.getElementById('bottomGroupSelect').value);
    }
}

function loadCustomerInfo() {
    const customerName = localStorage.getItem('customerName');
    const customerPhone = localStorage.getItem('customerPhone');
    const customerAddress = localStorage.getItem('customerAddress');
    
    if (customerName) document.getElementById('customerName').value = customerName;
    if (customerPhone) document.getElementById('customerPhone').value = customerPhone;
    if (customerAddress) document.getElementById('customerAddress').value = customerAddress;
}

// Image Modal Functions
function openImageModal(imageSrc) {
	const modal = document.getElementById("image-modal");
	const modalImg = document.getElementById("modal-image");
	modal.style.display = "flex";
	modalImg.src = imageSrc;
	// Push a new state to history when modal is opened
	history.pushState({ modal: 'open' }, 'Image Modal', '#image-modal');
}

function closeImageModal() {
	const modal = document.getElementById("image-modal");
	modal.style.display = "none";
	// If the current history state indicates the modal is open, go back one step.
	if (history.state && history.state.modal === 'open') {
		history.back();
	}
}

function checkCartState() {
  const clearCartBtnSection = document.getElementById('clearCartButtonSection');
  if (cart.size > 0) {
    clearCartBtnSection.style.display = 'flex';
  } else {
    clearCartBtnSection.style.display = 'none';
  }
}

function handleLoad() {
    const initialHash = window.location.hash.substring(1);
    if (initialHash && screens[initialHash]) {
        showScreen(initialHash);
    } else {
        showScreen('main');
    }
    history.replaceState({ screen: initialHash || 'main' }, '', `#${initialHash || 'main'}`);
    renderCartList();
    loadCustomerInfo();
    checkCartState();
    
    // ** ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø¯Ø± Ø²Ù…Ø§Ù† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„ ØµÙØ­Ù‡ **
    showWelcomeNotification('Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù† Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.');

    document.getElementById('enterAsUserBtn').addEventListener('click', () => { showScreen('gallery'); });
    document.getElementById('showCartBtn').addEventListener('click', () => showScreen('cart'));
    document.getElementById('clearCartMainBtn').addEventListener('click', () => clearCart());
    document.getElementById('loginAsAdminBtn').addEventListener('click', () => loginAsAdmin());
    document.getElementById('bottomGroupSelect').addEventListener('change', (e) => loadGroup(e.target.value));
    document.getElementById('showHomeGalleryBtn').addEventListener('click', () => showScreen('main'));
    document.getElementById('showCartGalleryBtn').addEventListener('click', () => showScreen('cart'));
    document.getElementById('submitOrderBtn').addEventListener('click', () => submitOrderWithWhatsApp());
    document.getElementById('clearCartCartBtn').addEventListener('click', () => clearCart());
    document.getElementById('showGalleryCartBtn').addEventListener('click', () => showScreen('gallery'));
    document.getElementById('showPreviousOrdersBtn').addEventListener('click', () => openPreviousOrdersModal());
}

// Previous Orders Modal Functions
function openPreviousOrdersModal() {
    const modal = document.getElementById("previous-orders-modal");
    const list = document.getElementById("previousOrdersList");
    list.innerHTML = "";

    const ordersHistory = JSON.parse(localStorage.getItem('previousOrders') || '[]');

    if (ordersHistory.length === 0) {
        list.innerHTML = "<p>Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ Ù‚Ø¨Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯.</p>";
    } else {
        ordersHistory.reverse().forEach(order => {
            const orderDiv = document.createElement("div");
            orderDiv.className = "previous-order-item";

            let orderDetails = `<p><strong>ØªØ§Ø±ÛŒØ® Ø³ÙØ§Ø±Ø´:</strong> ${order.date}</p>`;
            orderDetails += `<p><strong>Ù…Ø¨Ù„Øº Ú©Ù„:</strong> ${order.totalPrice.toLocaleString()} Ø±ÛŒØ§Ù„</p>`;
            
            const groupedOrderItems = order.items.reduce((acc, item) => {
                if (!acc[item.groupName]) {
                    acc[item.groupName] = [];
                }
                acc[item.groupName].push(item);
                return acc;
            }, {});

            orderDetails += `<ul>`;
            for (const groupName in groupedOrderItems) {
                if (groupedOrderItems.hasOwnProperty(groupName)) {
                    orderDetails += `<li><strong>${groupName}:</strong></li>`;
                    groupedOrderItems[groupName].forEach(item => {
                        orderDetails += `<ul><li>${item.name} (${item.qty} Ø¹Ø¯Ø¯)</li></ul>`;
                    });
                }
            }
            orderDetails += `</ul>`;
            
            orderDiv.innerHTML = `
                <h4>Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§Ø±Ù‡: ${order.id}</h4>
                ${orderDetails}
                <div class="previous-order-buttons">
                    <button onclick="reorderPreviousOrder(${order.id})">Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯</button>
                    <button class="delete-btn" onclick="deletePreviousOrder(${order.id})">Ø­Ø°Ù Ø³ÙØ§Ø±Ø´</button>
                </div>
            `;
            list.appendChild(orderDiv);
        });
    }

    modal.style.display = "flex";
    if (history.state === null || history.state.modal !== 'previous-orders-open') {
      history.pushState({ modal: 'previous-orders-open' }, 'Previous Orders Modal', '#previous-orders-modal');
    }
}

function closePreviousOrdersModal() {
    const modal = document.getElementById("previous-orders-modal");
    modal.style.display = "none";
    if (history.state && history.state.modal === 'previous-orders-open') {
      history.back();
    }
}

function reorderPreviousOrder(orderId) {
    const ordersHistory = JSON.parse(localStorage.getItem('previousOrders') || '[]');
    const orderToReorder = ordersHistory.find(order => parseInt(order.id) === orderId);

    if (orderToReorder) {
        cart.clear(); // Clear the current cart
        orderToReorder.items.forEach(item => {
            const itemUniqueId = `${item.groupId}-${item.filename}`;
            cart.set(itemUniqueId, item);
        });
        saveCart();
        closePreviousOrdersModal();
        showNotification(`Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§Ø±Ù‡ ${orderId} Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`);
        showScreen('cart');
    } else {
        showNotification('Ø³ÙØ§Ø±Ø´ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.');
    }
}

function deletePreviousOrder(orderId) {
    if (confirm(`Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§Ø±Ù‡ ${orderId} Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ`)) {
        let ordersHistory = JSON.parse(localStorage.getItem('previousOrders') || '[]');
        ordersHistory = ordersHistory.filter(order => parseInt(order.id) !== orderId);
        localStorage.setItem('previousOrders', JSON.stringify(ordersHistory));
        showNotification(`Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§Ø±Ù‡ ${orderId} Ø­Ø°Ù Ø´Ø¯.`);
        // Re-render the modal to show the updated list
        openPreviousOrdersModal();
    }
}


window.addEventListener('load', handleLoad);
// Add a listener for the browser's popstate event (back button)
window.addEventListener('popstate', function(event) {
	const imageModal = document.getElementById("image-modal");
  const previousOrdersModal = document.getElementById("previous-orders-modal");

	// If the image modal is open and the state is not the one we pushed, close it.
	if (imageModal.style.display === 'flex' && (!event.state || event.state.modal !== 'open')) {
		closeImageModal();
	}
  // If the previous orders modal is open and the state is not the one we pushed, close it.
  if (previousOrdersModal.style.display === 'flex' && (!event.state || event.state.modal !== 'previous-orders-open')) {
    closePreviousOrdersModal();
  }
});

</script>

<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/service-worker.js?v=1.9').then(function(registration) {
                console.log('âœ… Service Worker Ø«Ø¨Øª Ø´Ø¯: ', registration.scope);
            }).catch(function(error) {
                console.log('âŒ Ø«Ø¨Øª Service Worker Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯:', error);
            });
        });
    }
</script>

<footer style="text-align: center; margin-top: 10px; color: white;">
    <p>All rights reserved for Poster Iran Â© 2025</p>
</footer>
</body>
</html>